---
title: "Final_Project"
author: "Cameron Chambers, Bram Stults, Priscilla Wen"
date: "2024-04-02"
output: html_document
header-includes:
   - \usepackage{multirow}
editor_options: 
  chunk_output_type: console
urlcolor: blue
---

# Introduction
//Begin paper here

### Background 
//Discuss background of our project here


# Mathematics behind Divisive Hierarchical Clustering
//Mathematics information here


# Analysis on our Dataset
//Analysis here


# Diagnostic and Remedial Measures
//Diagnostics here


# Strengths, Weaknesses, and Uses
//Information regarding our ML model here


# Conclusion
//Conclusion of paper here


# References
//References used here


# RShiny App
``` {r}
library(dendextend)
library(ggplot2)
library(plotly)
library(shiny)
library(factoextra)
library(cluster)
library(stats)

data = read.csv("Studio Ghibli [TEST].csv", header = TRUE, row.names = 1)

data_new <- na.omit(data)
data_new <- data_new[c("Year", "Budget", "Revenue", "Duration")]
col_names <- c("Year", "Budget_in_$M", "Revenue_in_$", "Duration_in_Minutes")
data_new <- setNames(data_new, col_names)
data_new <- matrix(data_new)

clean_data <- apply(data_new, 2, function(column) {
  if(any(is.na(column))) {
    column[is.na(column)] <- mean(column, na.rm = TRUE)
  }
  return(column)
})

```

``` {r}
dend <- data %>%
  dist() %>%
  hclust(method = "ave") %>%
  as.dendrogram()
dend2 <- color_branches(dend, 5)

p <- ggplot(dend2, horiz = T, offset_labels = -3)
ggplotly(p)

# Calculate distance matrix and hierarchical clustering
dist_matrix <- dist(data)
hc <- hclust(dist_matrix)

# Create dendrogram object
dend <- as.dendrogram(hc)

# Color the dendrogram based on clusters
dend_colored <- color_branches(dend, k = 4)  # You can change the number of clusters as needed

# Plot the dendrogram
plot(dend_colored, main = "Colored Dendrogram")

# Add legend for colors
legend("topright", legend = unique(dend_colored$labels$color_groups), 
       fill = unique(dend_colored$labels$color_groups), title = "Cluster")

# If you prefer ggplot2 for better customization:
# ggplot(dend_colored, horiz = TRUE) + theme_minimal() +
#   geom_segment(aes(x = x, y = y, xend = xend, yend = yend, color = color_groups)) +
#   scale_color_manual(values = unique(dend_colored$labels$color_groups)) +
#   theme(legend.position="top")
```

